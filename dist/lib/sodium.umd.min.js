!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Sodium",[],e):"object"==typeof exports?exports.Sodium=e():t.Sodium=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1);e.lambda1=r.lambda1,e.lambda2=r.lambda2,e.lambda3=r.lambda3,e.lambda4=r.lambda4,e.lambda5=r.lambda5,e.lambda6=r.lambda6;var i=n(3);e.Stream=i.Stream,e.StreamLoop=i.StreamLoop;var o=n(26);e.StreamSink=o.StreamSink;var s=n(20);e.Cell=s.Cell;var u=n(27);e.CellLoop=u.CellLoop;var a=n(28);e.CellSink=a.CellSink;var c=n(4);e.Transaction=c.Transaction;var l=n(29);e.Tuple2=l.Tuple2;var f=n(23);e.Unit=f.Unit;var h=n(22);e.Operational=h.Operational;var p=n(2);e.getTotalRegistrations=p.getTotalRegistrations,e.Vertex=p.Vertex;var d=n(30);e.TimerSystemImpl=d.TimerSystemImpl,e.TimerSystem=d.TimerSystem;var y=n(31);e.SecondsTimerSystem=y.SecondsTimerSystem;var v=n(32);e.MillisecondsTimerSystem=v.MillisecondsTimerSystem;var m=n(33);e.IOAction=m.IOAction},function(t,e,n){"use strict";function r(t,e){return new T(t,e)}function i(t){return t instanceof T?t.deps:[]}function o(t){return t instanceof T?t.f:t}function s(t,e){return new b(t,e)}function u(t){return t instanceof b?t.deps:[]}function a(t){return t instanceof b?t.f:t}function c(t,e){return new C(t,e)}function l(t){return t instanceof C?t.deps:[]}function f(t){return t instanceof C?t.f:t}function h(t,e){return new E(t,e)}function p(t){return t instanceof E?t.deps:[]}function d(t){return t instanceof E?t.f:t}function y(t,e){return new L(t,e)}function v(t){return t instanceof L?t.deps:[]}function m(t){return t instanceof L?t.f:t}function _(t,e){return new k(t,e)}function g(t){return t instanceof k?t.deps:[]}function x(t){return t instanceof k?t.f:t}function w(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(new S.Source(r.getVertex__(),null))}return e}var S=n(2),T=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda1=T,e.lambda1=r,e.Lambda1_deps=i,e.Lambda1_toFunction=o;var b=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda2=b,e.lambda2=s,e.Lambda2_deps=u,e.Lambda2_toFunction=a;var C=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda3=C,e.lambda3=c,e.Lambda3_deps=l,e.Lambda3_toFunction=f;var E=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda4=E,e.lambda4=h,e.Lambda4_deps=p,e.Lambda4_toFunction=d;var L=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda5=L,e.lambda5=y,e.Lambda5_deps=v,e.Lambda5_toFunction=m;var k=function(){function t(t,e){this.f=t,this.deps=e}return t}();e.Lambda6=k,e.lambda6=_,e.Lambda6_deps=g,e.Lambda6_toFunction=x,e.toSources=w},function(t,e){"use strict";function n(){return o}function r(t){l=t}function i(t,e){if(!e.contains(t.id)){console.log(t.descr()),e.add(t.id);for(var n=t.children(),r=0;r<n.length;r++)i(n[r],e)}}var o=0;e.getTotalRegistrations=n;var s=function(){function t(t,e){if(this.registered=!1,this.deregister_=null,null===t)throw new Error("null origin!");this.origin=t,this.register_=e}return t.prototype.register=function(t){var e=this;this.registered||(this.registered=!0,null!==this.register_?this.deregister_=this.register_():(this.origin.increment(t),this.deregister_=function(){return e.origin.decrement(t)}))},t.prototype.deregister=function(t){this.registered&&(this.registered=!1,null!==this.deregister_&&this.deregister_())},t}();e.Source=s,function(t){t[t.black=0]="black",t[t.gray=1]="gray",t[t.white=2]="white",t[t.purple=3]="purple"}(e.Color||(e.Color={}));var u=e.Color,a=[],c=0,l=!1;e.setVerbose=r,e.describeAll=i;var f=function(){function t(t,e,n){this.targets=[],this.childrn=[],this.visited=!1,this.color=u.black,this.buffered=!1,this.refCountAdj=0,this.name=t,this.rank=e,this.sources=n,this.id=c++}return t.prototype.refCount=function(){return this.targets.length},t.prototype.register=function(t){return this.increment(t)},t.prototype.deregister=function(e){l&&console.log("deregister "+this.descr()+" => "+e.descr()),this.decrement(e),t.collectCycles()},t.prototype.incRefCount=function(t){var e=!1;if(0==this.refCount())for(var n=0;n<this.sources.length;n++)this.sources[n].register(this);return this.targets.push(t),t.childrn.push(this),t.ensureBiggerThan(this.rank)&&(e=!0),o++,e},t.prototype.decRefCount=function(t){l&&console.log("DEC "+this.descr());for(var e=!1,n=0;n<t.childrn.length;n++)t.childrn[n]===this&&t.childrn.splice(n,1);for(var n=0;n<this.targets.length;n++)if(this.targets[n]===t){this.targets.splice(n,1),e=!0;break}if(e){if(0==this.refCount())for(var n=0;n<this.sources.length;n++)this.sources[n].deregister(this);o--}},t.prototype.addSource=function(t){this.sources.push(t),this.refCount()>0&&t.register(this)},t.prototype.ensureBiggerThan=function(t){if(this.rank>t||this.visited)return!1;this.visited=!0,this.rank=t+1;for(var e=0;e<this.targets.length;e++)this.targets[e].ensureBiggerThan(this.rank);return this.visited=!1,!0},t.prototype.descr=function(){var t=null;switch(this.color){case u.black:t="black";break;case u.gray:t="gray";break;case u.white:t="white";break;case u.purple:t="purple"}for(var e=this.id+" "+this.name+" ["+this.refCount()+"/"+this.refCountAdj+"] "+t+" ->",n=this.children(),r=0;r<n.length;r++)e=e+" "+n[r].id;return e},t.prototype.children=function(){return this.childrn},t.prototype.increment=function(t){return this.incRefCount(t)},t.prototype.decrement=function(t){this.decRefCount(t),0==this.refCount()?this.release():this.possibleRoots()},t.prototype.release=function(){this.color=u.black,this.buffered||this.free()},t.prototype.free=function(){for(;this.targets.length>0;)this.decRefCount(this.targets[0])},t.prototype.possibleRoots=function(){this.color!=u.purple&&(this.color=u.purple,this.buffered||(this.buffered=!0,a.push(this)))},t.collectCycles=function(){t.markRoots(),t.scanRoots(),t.collectRoots()},t.markRoots=function(){for(var t=[],e=0;e<a.length;e++)l&&console.log("markRoots "+a[e].descr()),a[e].color==u.purple?(a[e].markGray(),t.push(a[e])):(a[e].buffered=!1,a[e].color==u.black&&0==a[e].refCount()&&a[e].free());a=t},t.scanRoots=function(){for(var t=0;t<a.length;t++)a[t].scan()},t.collectRoots=function(){for(var t=0;t<a.length;t++)a[t].buffered=!1,a[t].collectWhite();a=[]},t.prototype.markGray=function(){if(this.color!=u.gray){this.color=u.gray;for(var t=this.children(),e=0;e<t.length;e++)t[e].refCountAdj--,l&&console.log("markGray "+this.descr()),t[e].markGray()}},t.prototype.scan=function(){if(l&&console.log("scan "+this.descr()),this.color==u.gray)if(this.refCount()+this.refCountAdj>0)this.scanBlack();else{this.color=u.white,l&&console.log("scan WHITE "+this.descr());for(var t=this.children(),e=0;e<t.length;e++)t[e].scan()}},t.prototype.scanBlack=function(){this.color=u.black;for(var t=this.children(),e=0;e<t.length;e++)t[e].refCountAdj++,l&&console.log("scanBlack "+this.descr()),t[e].color!=u.black&&t[e].scanBlack()},t.prototype.collectWhite=function(){if(this.color==u.white&&!this.buffered){l&&console.log("collectWhite "+this.descr()),this.color=u.black,this.refCountAdj=0;for(var t=this.children(),e=0;e<t.length;e++)t[e].collectWhite();this.free()}},t.NULL=new t("user",1e12,[]),t}();e.Vertex=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(1),o=n(2),s=n(4),u=n(19),a=n(20),c=n(24),l=n(21),f=n(25),h=function(){function t(t){this.listeners=[],this.firings=[],this.vertex=t?t:new o.Vertex("Stream",0,[])}return t.prototype.getVertex__=function(){return this.vertex},t.prototype.map=function(t){var e=this,n=new p(null),r=i.Lambda1_toFunction(t);return n.vertex=new o.Vertex("map",0,[new o.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){n.send_(r(t))},!1)})].concat(i.toSources(i.Lambda1_deps(t)))),n},t.prototype.mapTo=function(t){var e=this,n=new p(null);return n.vertex=new o.Vertex("mapTo",0,[new o.Source(this.vertex,function(){return e.listen_(n.vertex,function(e){n.send_(t)},!1)})]),n},t.prototype.orElse=function(t){return this.merge(t,function(t,e){return t})},t.prototype.merge_=function(t){var e=this,n=new p,r=new o.Vertex("merge",0,[]);return r.sources.push(new o.Source(this.vertex,function(){return e.listen_(r,function(t){n.send_(t)},!1)})),n.vertex.sources=n.vertex.sources.concat([new o.Source(r,function(){return r.register(n.vertex),function(){r.deregister(n.vertex)}}),new o.Source(t.vertex,function(){return t.listen_(n.vertex,function(t){n.send_(t)},!1)})]),n},t.prototype.coalesce__=function(t){var e=this,n=new p,r=new u.CoalesceHandler(t,n);return n.vertex.sources=n.vertex.sources.concat([new o.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){r.send_(t)},!1)})]).concat(i.toSources(i.Lambda2_deps(t))),n},t.prototype.merge=function(t,e){var n=this;return s.Transaction.transactionally(function(){return n.merge_(t).coalesce__(e)})},t.prototype.filter=function(t){var e=this,n=new p(null),r=i.Lambda1_toFunction(t);return n.vertex=new o.Vertex("filter",0,[new o.Source(this.vertex,function(){return e.listen_(n.vertex,function(t){r(t)&&n.send_(t)},!1)})].concat(i.toSources(i.Lambda1_deps(t)))),n},t.prototype.filterNotNull=function(){var t=this,e=new p(null);return e.vertex=new o.Vertex("filterNotNull",0,[new o.Source(this.vertex,function(){return t.listen_(e.vertex,function(t){null!==t&&e.send_(t)},!1)})]),e},t.prototype.gate=function(t){return this.snapshot(t,function(t,e){return e?t:null}).filterNotNull()},t.prototype.snapshot1=function(t){var e=this,n=new p(null);return n.vertex=new o.Vertex("snapshot1",0,[new o.Source(this.vertex,function(){return e.listen_(n.vertex,function(e){n.send_(t.sampleNoTrans__())},!1)}),new o.Source(t.getVertex__(),null)]),n},t.prototype.snapshot=function(t,e){var n=this,r=new p(null),s=i.Lambda2_toFunction(e);return r.vertex=new o.Vertex("snapshot",0,[new o.Source(this.vertex,function(){return n.listen_(r.vertex,function(e){r.send_(s(e,t.sampleNoTrans__()))},!1)}),new o.Source(t.getVertex__(),null)].concat(i.toSources(i.Lambda2_deps(e)))),r},t.prototype.hold=function(t){return new a.Cell(t,this)},t.prototype.holdLazy=function(t){return new f.LazyCell(t,this)},t.prototype.collect=function(t,e){return this.collectLazy(new l.Lazy(function(){return t}),e)},t.prototype.collectLazy=function(t,e){var n=this;return s.Transaction.transactionally(function(){var r=new d,i=r.holdLazy(t),o=n.snapshot(i,e),s=o.map(function(t){return t.a}),u=o.map(function(t){return t.b});return r.loop(u),s})},t.prototype.accum=function(t,e){return this.accumLazy(new l.Lazy(function(){return t}),e)},t.prototype.accumLazy=function(t,e){var n=this;return s.Transaction.transactionally(function(){var r=new d,i=r.holdLazy(t),o=n.snapshot(i,e);return r.loop(o),o.holdLazy(t)})},t.prototype.once=function(){var t=this;return s.Transaction.transactionally(function(){return t.gate(t.mapTo(!1).hold(!0))})},t.prototype.listen=function(t){var e=this;return s.Transaction.transactionally(function(){return e.listen_(o.Vertex.NULL,t,!1)})},t.prototype.listen_=function(t,e,n){var r=this;this.vertex.register(t)&&s.Transaction.currentTransaction.requestRegen();var i=new c.Listener(e,t);if(this.listeners.push(i),!n&&0!=this.firings.length){var o=this.firings.slice();s.Transaction.currentTransaction.prioritized(t,function(){for(var t=0;t<o.length;t++)e(o[t])})}return function(){for(var e=!1,n=0;n<r.listeners.length;n++)if(r.listeners[n]==i){r.listeners.splice(n,1),e=!0;break}e&&r.vertex.deregister(t)}},t}();e.Stream=h;var p=function(t){function e(e){t.call(this,e)}return r(e,t),e.prototype.setVertex__=function(t){this.vertex=t},e.prototype.send_=function(t){var e=this;if(0==this.vertex.refCount())throw new Error("send() was invoked before listeners were registered");0==this.firings.length&&s.Transaction.currentTransaction.last(function(){e.firings=[]}),this.firings.push(t);for(var n=this.listeners.slice(),r=function(e){var r=n[e].h;s.Transaction.currentTransaction.prioritized(n[e].target,function(){s.Transaction.currentTransaction.inCallback++;try{r(t),s.Transaction.currentTransaction.inCallback--}catch(t){throw s.Transaction.currentTransaction.inCallback--,t}})},i=0;i<n.length;i++)r(i)},e}(h);e.StreamWithSend=p;var d=function(t){function e(){if(t.call(this),this.assigned__=!1,this.vertex.name="StreamLoop",null===s.Transaction.currentTransaction)throw new Error("StreamLoop/CellLoop must be used within an explicit transaction")}return r(e,t),e.prototype.loop=function(t){var e=this;if(this.assigned__)throw new Error("StreamLoop looped more than once");this.assigned__=!0,this.vertex.addSource(new o.Source(t.getVertex__(),function(){return t.listen_(e.vertex,function(t){e.send_(t)},!1)}))},e}(p);e.StreamLoop=d},function(t,e,n){"use strict";var r=n(5),i=function(){function t(e,n){this.rank=e,this.action=n,this.seq=t.nextSeq++}return t.prototype.toString=function(){return this.seq.toString()},t.nextSeq=0,t}();e.Entry=i;var o=function(){function t(){this.inCallback=0,this.toRegen=!1,this.prioritizedQ=new r.PriorityQueue(function(t,e){return t.rank.rank<e.rank.rank?1:t.rank.rank>e.rank.rank?-1:t.seq<e.seq?1:t.seq>e.seq?-1:0}),this.entries=new r.Set(function(t){return t.toString()}),this.lastQ=[],this.postQ=null}return t.prototype.requestRegen=function(){this.toRegen=!0},t.prototype.prioritized=function(t,e){var n=new i(t,e);this.prioritizedQ.enqueue(n),this.entries.add(n)},t.prototype.last=function(t){this.lastQ.push(t)},t.prototype.post=function(t,e){for(null==this.postQ&&(this.postQ=[]);this.postQ.length<=t;)this.postQ.push(null);var n=this.postQ[t],r=null===n?e:function(){n(),e()};this.postQ[t]=r},t.prototype.checkRegen=function(){if(this.toRegen){this.toRegen=!1,this.prioritizedQ.clear();for(var t=this.entries.toArray(),e=0;e<t.length;e++)this.prioritizedQ.enqueue(t[e])}},t.prototype.close=function(){for(;;){if(this.checkRegen(),this.prioritizedQ.isEmpty())break;var e=this.prioritizedQ.dequeue();this.entries.remove(e),e.action()}for(var n=0;n<this.lastQ.length;n++)this.lastQ[n]();if(this.lastQ=[],null!=this.postQ){for(var n=0;n<this.postQ.length;n++)if(null!=this.postQ[n]){var r=t.currentTransaction;try{if(n>0){t.currentTransaction=new t;try{this.postQ[n](),t.currentTransaction.close()}catch(e){throw t.currentTransaction.close(),e}}else t.currentTransaction=null,this.postQ[n]();t.currentTransaction=r}catch(e){throw t.currentTransaction=r,e}}this.postQ=null}},t.onStart=function(e){t.onStartHooks.push(e)},t.transactionally=function(e){var n=t.currentTransaction;if(null===n){if(!t.runningOnStartHooks){t.runningOnStartHooks=!0;try{for(var r=0;r<t.onStartHooks.length;r++)t.onStartHooks[r]()}finally{t.runningOnStartHooks=!1}}t.currentTransaction=new t}try{var i=e();return null===n&&(t.currentTransaction.close(),t.currentTransaction=null),i}catch(e){throw null===n&&(t.currentTransaction.close(),t.currentTransaction=null),e}},t.currentTransaction=null,t.onStartHooks=[],t.runningOnStartHooks=!1,t}();e.Transaction=o},function(t,e,n){"use strict";var r=n(6);e.arrays=r;var i=n(8);e.Bag=i.default;var o=n(11);e.BSTree=o.default;var s=n(9);e.Dictionary=s.default;var u=n(14);e.Heap=u.default;var a=n(15);e.LinkedDictionary=a.default;var c=n(13);e.LinkedList=c.default;var l=n(16);e.MultiDictionary=l.default;var f=n(12);e.Queue=f.default;var h=n(17);e.PriorityQueue=h.default;var p=n(10);e.Set=p.default;var d=n(18);e.Stack=d.default;var y=n(7);e.util=y},function(t,e,n){"use strict";function r(t,e,n){for(var r=n||p.defaultEquals,i=t.length,o=0;o<i;o++)if(r(t[o],e))return o;return-1}function i(t,e,n){for(var r=n||p.defaultEquals,i=t.length,o=i-1;o>=0;o--)if(r(t[o],e))return o;return-1}function o(t,e,n){return r(t,e,n)>=0}function s(t,e,n){var i=r(t,e,n);return!(i<0)&&(t.splice(i,1),!0)}function u(t,e,n){for(var r=n||p.defaultEquals,i=t.length,o=0,s=0;s<i;s++)r(t[s],e)&&o++;return o}function a(t,e,n){var r=n||p.defaultEquals;if(t.length!==e.length)return!1;for(var i=t.length,o=0;o<i;o++)if(!r(t[o],e[o]))return!1;return!0}function c(t){return t.concat()}function l(t,e,n){if(e<0||e>=t.length||n<0||n>=t.length)return!1;var r=t[e];return t[e]=t[n],t[n]=r,!0}function f(t){return"["+t.toString()+"]"}function h(t,e){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e(i)===!1)return}}var p=n(7);e.indexOf=r,e.lastIndexOf=i,e.contains=o,e.remove=s,e.frequency=u,e.equals=a,e.copy=c,e.swap=l,e.toString=f,e.forEach=h},function(t,e){"use strict";function n(t,e){return t<e?-1:t===e?0:1}function r(t,e){return t===e}function i(t){return null===t?"COLLECTION_NULL":u(t)?"COLLECTION_UNDEFINED":a(t)?"$s"+t:"$o"+t.toString()}function o(t,n){if(void 0===n&&(n=","),null===t)return"COLLECTION_NULL";if(u(t))return"COLLECTION_UNDEFINED";if(a(t))return t.toString();var r="{",i=!0;for(var o in t)e.has(t,o)&&(i?i=!1:r+=n,r=r+o+":"+t[o]);return r+"}"}function s(t){return"function"==typeof t}function u(t){return"undefined"==typeof t}function a(t){return"[object String]"===Object.prototype.toString.call(t)}function c(t){return s(t)?function(e,n){return t(e,n)*-1}:function(t,e){return t<e?1:t===e?0:-1}}function l(t){return function(e,n){return 0===t(e,n)}}var f=Object.prototype.hasOwnProperty;e.has=function(t,e){return f.call(t,e)},e.defaultCompare=n,e.defaultEquals=r,e.defaultToString=i,e.makeString=o,e.isFunction=s,e.isUndefined=u,e.isString=a,e.reverseCompareFunction=c,e.compareToEquals=l},function(t,e,n){"use strict";var r=n(7),i=n(9),o=n(10),s=function(){function t(t){this.toStrF=t||r.defaultToString,this.dictionary=new i.default(this.toStrF),this.nElements=0}return t.prototype.add=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t))this.dictionary.getValue(t).copies+=e;else{var n={value:t,copies:e};this.dictionary.setValue(t,n)}return this.nElements+=e,!0},t.prototype.count=function(t){return this.contains(t)?this.dictionary.getValue(t).copies:0},t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.remove=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t)){var n=this.dictionary.getValue(t);return e>n.copies?this.nElements-=n.copies:this.nElements-=e,n.copies-=e,n.copies<=0&&this.dictionary.remove(t),!0}return!1},t.prototype.toArray=function(){for(var t=[],e=this.dictionary.values(),n=0,r=e;n<r.length;n++)for(var i=r[n],o=i.value,s=i.copies,u=0;u<s;u++)t.push(o);return t},t.prototype.toSet=function(){for(var t=new o.default(this.toStrF),e=this.dictionary.values(),n=0,r=e;n<r.length;n++){var i=r[n],s=i.value;t.add(s)}return t},t.prototype.forEach=function(t){this.dictionary.forEach(function(e,n){for(var r=n.value,i=n.copies,o=0;o<i;o++)if(t(r)===!1)return!1;return!0})},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(7),i=function(){function t(t){this.table={},this.nElements=0,this.toStr=t||r.defaultToString}return t.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if(!r.isUndefined(e))return e.value},t.prototype.setValue=function(t,e){if(!r.isUndefined(t)&&!r.isUndefined(e)){var n,i="$"+this.toStr(t),o=this.table[i];return r.isUndefined(o)?(this.nElements++,n=void 0):n=o.value,this.table[i]={key:t,value:e},n}},t.prototype.remove=function(t){var e="$"+this.toStr(t),n=this.table[e];if(!r.isUndefined(n))return delete this.table[e],this.nElements--,n.value},t.prototype.keys=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.key)}return t},t.prototype.values=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.value)}return t},t.prototype.forEach=function(t){for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e],i=t(n.key,n.value);if(i===!1)return}},t.prototype.containsKey=function(t){return!r.isUndefined(this.getValue(t))},t.prototype.clear=function(){this.table={},this.nElements=0},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){var t="{";return this.forEach(function(e,n){t+="\n\t"+e+" : "+n}),t+"\n}"},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(7),i=n(6),o=n(9),s=function(){function t(t){this.dictionary=new o.default(t)}return t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.add=function(t){return!this.contains(t)&&!r.isUndefined(t)&&(this.dictionary.setValue(t,t),!0)},t.prototype.intersection=function(t){var e=this;this.forEach(function(n){return t.contains(n)||e.remove(n),!0})},t.prototype.union=function(t){var e=this;t.forEach(function(t){return e.add(t),!0})},t.prototype.difference=function(t){var e=this;t.forEach(function(t){return e.remove(t),!0})},t.prototype.isSubsetOf=function(t){if(this.size()>t.size())return!1;var e=!0;return this.forEach(function(n){return!!t.contains(n)||(e=!1,!1)}),e},t.prototype.remove=function(t){return!!this.contains(t)&&(this.dictionary.remove(t),!0)},t.prototype.forEach=function(t){this.dictionary.forEach(function(e,n){return t(n)})},t.prototype.toArray=function(){return this.dictionary.values()},t.prototype.isEmpty=function(){return this.dictionary.isEmpty()},t.prototype.size=function(){return this.dictionary.size()},t.prototype.clear=function(){this.dictionary.clear()},t.prototype.toString=function(){return i.toString(this.toArray())},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(7),i=n(12),o=function(){function t(t){this.root=null,this.compare=t||r.defaultCompare,this.nElements=0}return t.prototype.add=function(t){return!r.isUndefined(t)&&(null!==this.insertNode(this.createNode(t))&&(this.nElements++,!0))},t.prototype.clear=function(){this.root=null,this.nElements=0},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.size=function(){return this.nElements},t.prototype.contains=function(t){return!r.isUndefined(t)&&null!==this.searchNode(this.root,t)},t.prototype.remove=function(t){var e=this.searchNode(this.root,t);return null!==e&&(this.removeNode(e),this.nElements--,!0)},t.prototype.inorderTraversal=function(t){this.inorderTraversalAux(this.root,t,{stop:!1})},t.prototype.preorderTraversal=function(t){this.preorderTraversalAux(this.root,t,{stop:!1})},t.prototype.postorderTraversal=function(t){this.postorderTraversalAux(this.root,t,{stop:!1})},t.prototype.levelTraversal=function(t){this.levelTraversalAux(this.root,t)},t.prototype.minimum=function(){if(!this.isEmpty())return this.minimumAux(this.root).element},t.prototype.maximum=function(){if(!this.isEmpty())return this.maximumAux(this.root).element},t.prototype.forEach=function(t){this.inorderTraversal(t)},t.prototype.toArray=function(){var t=[];return this.inorderTraversal(function(e){return t.push(e),!0}),t},t.prototype.height=function(){return this.heightAux(this.root)},t.prototype.searchNode=function(t,e){for(var n=null;null!==t&&0!==n;)n=this.compare(e,t.element),n<0?t=t.leftCh:n>0&&(t=t.rightCh);return t},t.prototype.transplant=function(t,e){null===t.parent?this.root=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,null!==e&&(e.parent=t.parent)},t.prototype.removeNode=function(t){if(null===t.leftCh)this.transplant(t,t.rightCh);else if(null===t.rightCh)this.transplant(t,t.leftCh);else{var e=this.minimumAux(t.rightCh);e.parent!==t&&(this.transplant(e,e.rightCh),e.rightCh=t.rightCh,e.rightCh.parent=e),this.transplant(t,e),e.leftCh=t.leftCh,e.leftCh.parent=e}},t.prototype.inorderTraversalAux=function(t,e,n){null===t||n.stop||(this.inorderTraversalAux(t.leftCh,e,n),n.stop||(n.stop=e(t.element)===!1,n.stop||this.inorderTraversalAux(t.rightCh,e,n)))},t.prototype.levelTraversalAux=function(t,e){var n=new i.default;for(null!==t&&n.enqueue(t);!n.isEmpty();){if(t=n.dequeue(),e(t.element)===!1)return;null!==t.leftCh&&n.enqueue(t.leftCh),null!==t.rightCh&&n.enqueue(t.rightCh)}},t.prototype.preorderTraversalAux=function(t,e,n){null===t||n.stop||(n.stop=e(t.element)===!1,n.stop||(this.preorderTraversalAux(t.leftCh,e,n),n.stop||this.preorderTraversalAux(t.rightCh,e,n)))},t.prototype.postorderTraversalAux=function(t,e,n){null===t||n.stop||(this.postorderTraversalAux(t.leftCh,e,n),n.stop||(this.postorderTraversalAux(t.rightCh,e,n),n.stop||(n.stop=e(t.element)===!1)))},t.prototype.minimumAux=function(t){for(;null!==t.leftCh;)t=t.leftCh;return t},t.prototype.maximumAux=function(t){for(;null!==t.rightCh;)t=t.rightCh;return t},t.prototype.heightAux=function(t){return null===t?-1:Math.max(this.heightAux(t.leftCh),this.heightAux(t.rightCh))+1},t.prototype.insertNode=function(t){for(var e=null,n=this.root,r=null;null!==n;){if(r=this.compare(t.element,n.element),0===r)return null;r<0?(e=n,n=n.leftCh):(e=n,n=n.rightCh)}return t.parent=e,null===e?this.root=t:this.compare(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t},t.prototype.createNode=function(t){return{element:t,leftCh:null,rightCh:null,parent:null}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=n(13),i=function(){function t(){this.list=new r.default}return t.prototype.enqueue=function(t){return this.list.add(t)},t.prototype.add=function(t){return this.list.add(t)},t.prototype.dequeue=function(){if(0!==this.list.size()){var t=this.list.first();return this.list.removeElementAtIndex(0),t}},t.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.size()<=0},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(7),i=n(6),o=function(){function t(){this.firstNode=null,this.lastNode=null,this.nElements=0}return t.prototype.add=function(t,e){if(r.isUndefined(e)&&(e=this.nElements),e<0||e>this.nElements||r.isUndefined(t))return!1;var n=this.createNode(t);if(0===this.nElements)this.firstNode=n,this.lastNode=n;else if(e===this.nElements)this.lastNode.next=n,this.lastNode=n;else if(0===e)n.next=this.firstNode,this.firstNode=n;else{var i=this.nodeAtIndex(e-1);n.next=i.next,i.next=n}return this.nElements++,!0},t.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},t.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},t.prototype.elementAtIndex=function(t){var e=this.nodeAtIndex(t);if(null!==e)return e.element},t.prototype.indexOf=function(t,e){var n=e||r.defaultEquals;if(r.isUndefined(t))return-1;for(var i=this.firstNode,o=0;null!==i;){if(n(i.element,t))return o;o++,i=i.next}return-1},t.prototype.contains=function(t,e){return this.indexOf(t,e)>=0},t.prototype.remove=function(t,e){var n=e||r.defaultEquals;if(this.nElements<1||r.isUndefined(t))return!1;for(var i=null,o=this.firstNode;null!==o;){if(n(o.element,t))return o===this.firstNode?(this.firstNode=this.firstNode.next,o===this.lastNode&&(this.lastNode=null)):o===this.lastNode?(this.lastNode=i,i.next=o.next,o.next=null):(i.next=o.next,o.next=null),this.nElements--,!0;i=o,o=o.next}return!1},t.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},t.prototype.equals=function(e,n){var i=n||r.defaultEquals;return e instanceof t&&(this.size()===e.size()&&this.equalsAux(this.firstNode,e.firstNode,i))},t.prototype.equalsAux=function(t,e,n){for(;null!==t;){if(!n(t.element,e.element))return!1;t=t.next,e=e.next}return!0},t.prototype.removeElementAtIndex=function(t){if(!(t<0||t>=this.nElements)){var e;if(1===this.nElements)e=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var n=this.nodeAtIndex(t-1);null===n?(e=this.firstNode.element,this.firstNode=this.firstNode.next):n.next===this.lastNode&&(e=this.lastNode.element,this.lastNode=n),null!==n&&(e=n.next.element,n.next=n.next.next)}return this.nElements--,e}},t.prototype.forEach=function(t){for(var e=this.firstNode;null!==e&&t(e.element)!==!1;)e=e.next},t.prototype.reverse=function(){for(var t=null,e=this.firstNode,n=null;null!==e;)n=e.next,e.next=t,t=e,e=n;n=this.firstNode,this.firstNode=this.lastNode,this.lastNode=n},t.prototype.toArray=function(){for(var t=[],e=this.firstNode;null!==e;)t.push(e.element),e=e.next;return t},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){return i.toString(this.toArray())},t.prototype.nodeAtIndex=function(t){if(t<0||t>=this.nElements)return null;if(t===this.nElements-1)return this.lastNode;for(var e=this.firstNode,n=0;n<t;n++)e=e.next;return e},t.prototype.createNode=function(t){return{element:t,next:null}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=n(7),i=n(6),o=function(){function t(t){this.data=[],this.compare=t||r.defaultCompare}return t.prototype.leftChildIndex=function(t){return 2*t+1},t.prototype.rightChildIndex=function(t){return 2*t+2},t.prototype.parentIndex=function(t){return Math.floor((t-1)/2)},t.prototype.minIndex=function(t,e){return e>=this.data.length?t>=this.data.length?-1:t:this.compare(this.data[t],this.data[e])<=0?t:e},t.prototype.siftUp=function(t){for(var e=this.parentIndex(t);t>0&&this.compare(this.data[e],this.data[t])>0;)i.swap(this.data,e,t),t=e,e=this.parentIndex(t)},t.prototype.siftDown=function(t){for(var e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t));e>=0&&this.compare(this.data[t],this.data[e])>0;)i.swap(this.data,e,t),t=e,e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t))},t.prototype.peek=function(){return this.data.length>0?this.data[0]:void 0},t.prototype.add=function(t){if(!r.isUndefined(t))return this.data.push(t),this.siftUp(this.data.length-1),!0},t.prototype.removeRoot=function(){if(this.data.length>0){var t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),t}},t.prototype.contains=function(t){var e=r.compareToEquals(this.compare);return i.contains(this.data,t,e)},t.prototype.size=function(){return this.data.length},t.prototype.isEmpty=function(){return this.data.length<=0},t.prototype.clear=function(){this.data.length=0},t.prototype.forEach=function(t){i.forEach(this.data,t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(9),o=n(7),s=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},t}(),u=function(t){function e(e){t.call(this,e),this.head=new s(null,null),this.tail=new s(null,null),this.head.next=this.tail,this.tail.prev=this.head}return r(e,t),e.prototype.appendToTail=function(t){var e=this.tail.prev;e.next=t,t.prev=e,t.next=this.tail,this.tail.prev=t},e.prototype.getLinkedDictionaryPair=function(t){if(!o.isUndefined(t)){var e="$"+this.toStr(t),n=this.table[e];return n}},e.prototype.getValue=function(t){var e=this.getLinkedDictionaryPair(t);if(!o.isUndefined(e))return e.value},e.prototype.remove=function(e){var n=this.getLinkedDictionaryPair(e);if(!o.isUndefined(n))return t.prototype.remove.call(this,e),n.unlink(),n.value},e.prototype.clear=function(){t.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head;
},e.prototype.replace=function(t,e){var n="$"+this.toStr(e.key);e.next=t.next,e.prev=t.prev,this.remove(t.key),e.prev.next=e,e.next.prev=e,this.table[n]=e,++this.nElements},e.prototype.setValue=function(t,e){if(!o.isUndefined(t)&&!o.isUndefined(e)){var n=this.getLinkedDictionaryPair(t),r=new s(t,e),i="$"+this.toStr(t);return o.isUndefined(n)?(this.appendToTail(r),this.table[i]=r,void++this.nElements):(this.replace(n,r),n.value)}},e.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(e)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},e.prototype.forEach=function(t){for(var e=this.head.next;null!=e.next;){var n=t(e.key,e.value);if(n===!1)return;e=e.next}},e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,n){"use strict";var r=n(7),i=n(9),o=n(6),s=function(){function t(t,e,n){void 0===n&&(n=!1),this.dict=new i.default(t),this.equalsF=e||r.defaultEquals,this.allowDuplicate=n}return t.prototype.getValue=function(t){var e=this.dict.getValue(t);return r.isUndefined(e)?[]:o.copy(e)},t.prototype.setValue=function(t,e){if(r.isUndefined(t)||r.isUndefined(e))return!1;if(!this.containsKey(t))return this.dict.setValue(t,[e]),!0;var n=this.dict.getValue(t);return!(!this.allowDuplicate&&o.contains(n,e,this.equalsF))&&(n.push(e),!0)},t.prototype.remove=function(t,e){if(r.isUndefined(e)){var n=this.dict.remove(t);return!r.isUndefined(n)}var i=this.dict.getValue(t);return!!o.remove(i,e,this.equalsF)&&(0===i.length&&this.dict.remove(t),!0)},t.prototype.keys=function(){return this.dict.keys()},t.prototype.values=function(){for(var t=this.dict.values(),e=[],n=0,r=t;n<r.length;n++)for(var i=r[n],o=0,s=i;o<s.length;o++){var u=s[o];e.push(u)}return e},t.prototype.containsKey=function(t){return this.dict.containsKey(t)},t.prototype.clear=function(){this.dict.clear()},t.prototype.size=function(){return this.dict.size()},t.prototype.isEmpty=function(){return this.dict.isEmpty()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(7),i=n(14),o=function(){function t(t){this.heap=new i.default(r.reverseCompareFunction(t))}return t.prototype.enqueue=function(t){return this.heap.add(t)},t.prototype.add=function(t){return this.heap.add(t)},t.prototype.dequeue=function(){if(0!==this.heap.size()){var t=this.heap.peek();return this.heap.removeRoot(),t}},t.prototype.peek=function(){return this.heap.peek()},t.prototype.contains=function(t){return this.heap.contains(t)},t.prototype.isEmpty=function(){return this.heap.isEmpty()},t.prototype.size=function(){return this.heap.size()},t.prototype.clear=function(){this.heap.clear()},t.prototype.forEach=function(t){this.heap.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=n(13),i=function(){function t(){this.list=new r.default}return t.prototype.push=function(t){return this.list.add(t,0)},t.prototype.add=function(t){return this.list.add(t,0)},t.prototype.pop=function(){return this.list.removeElementAtIndex(0)},t.prototype.peek=function(){return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.isEmpty()},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(1),i=n(4),o=function(){function t(t,e){this.f=r.Lambda2_toFunction(t),this.out=e,this.out.getVertex__().sources=this.out.getVertex__().sources.concat(r.toSources(r.Lambda2_deps(t))),this.accumValid=!1}return t.prototype.send_=function(t){var e=this;this.accumValid?this.accum=this.f(this.accum,t):(i.Transaction.currentTransaction.prioritized(this.out.getVertex__(),function(){e.out.send_(e.accum),e.accumValid=!1,e.accum=null}),this.accum=t,this.accumValid=!0)},t}();e.CoalesceHandler=o},function(t,e,n){"use strict";var r=n(1),i=n(2),o=n(4),s=n(21),u=n(3),a=n(22),c=function(){function t(t){this.hasValue=!1,this.value=null,this.cell=t}return t}(),l=function(){function t(){this.f=null,this.f_present=!1,this.a=null,this.a_present=!1}return t}(),f=function(){function t(t,e){var n=this;this.value=t,e?o.Transaction.transactionally(function(){return n.setStream(e)}):(this.str=new u.Stream,this.vertex=new i.Vertex("ConstCell",0,[]))}return t.prototype.setStream=function(t){var e=this;this.str=t;var n=this,r=new i.Source(t.getVertex__(),function(){return t.listen_(n.vertex,function(t){null==n.valueUpdate&&o.Transaction.currentTransaction.last(function(){n.value=n.valueUpdate,n.lazyInitValue=null,n.valueUpdate=null}),n.valueUpdate=t},!1)});this.vertex=new i.Vertex("Cell",0,[r]),this.vertex.register(i.Vertex.NULL),o.Transaction.currentTransaction.last(function(){e.vertex.deregister(i.Vertex.NULL)})},t.prototype.getVertex__=function(){return this.vertex},t.prototype.getStream__=function(){return this.str},t.prototype.sample=function(){var t=this;return o.Transaction.transactionally(function(){return t.sampleNoTrans__()})},t.prototype.sampleNoTrans__=function(){return this.value},t.prototype.sampleLazy=function(){var t=this;return o.Transaction.transactionally(function(){return t.sampleLazyNoTrans__()})},t.prototype.sampleLazyNoTrans__=function(){var t=this,e=new c(t);return o.Transaction.currentTransaction.last(function(){e.value=null!=t.valueUpdate?t.valueUpdate:t.sampleNoTrans__(),e.hasValue=!0,e.cell=null}),new s.Lazy(function(){return e.hasValue?e.value:e.cell.sample()})},t.prototype.map=function(t){var e=this;return o.Transaction.transactionally(function(){return a.Operational.updates(e).map(t).holdLazy(e.sampleLazy().map(r.Lambda1_toFunction(t)))})},t.prototype.lift=function(e,n){var i=r.Lambda2_toFunction(n),o=this.map(function(t){return function(e){return i(t,e)}});return t.apply(o,e,r.toSources(r.Lambda2_deps(n)))},t.prototype.lift3=function(e,n,i){var o=r.Lambda3_toFunction(i),s=function(t){return function(e){return function(n){return o(t,e,n)}}},u=this.map(s);return t.apply(t.apply(u,e),n,r.toSources(r.Lambda3_deps(i)))},t.prototype.lift4=function(e,n,i,o){var s=r.Lambda4_toFunction(o),u=function(t){return function(e){return function(n){return function(r){return s(t,e,n,r)}}}},a=this.map(u);return t.apply(t.apply(t.apply(a,e),n),i,r.toSources(r.Lambda4_deps(o)))},t.prototype.lift5=function(e,n,i,o,s){var u=r.Lambda5_toFunction(s),a=function(t){return function(e){return function(n){return function(r){return function(i){return u(t,e,n,r,i)}}}}},c=this.map(a);return t.apply(t.apply(t.apply(t.apply(c,e),n),i),o,r.toSources(r.Lambda5_deps(s)))},t.prototype.lift6=function(e,n,i,o,s,u){var a=r.Lambda6_toFunction(u),c=function(t){return function(e){return function(n){return function(r){return function(i){return function(o){return a(t,e,n,r,i,o)}}}}}},l=this.map(c);return t.apply(t.apply(t.apply(t.apply(t.apply(l,e),n),i),o),s,r.toSources(r.Lambda6_deps(u)))},t.apply=function(t,e,n){return o.Transaction.transactionally(function(){var r=new l,o=new u.StreamWithSend,c=a.Operational.value(t),f=a.Operational.value(e),h=new i.Source(c.getVertex__(),function(){return c.listen_(o.getVertex__(),function(t){r.f=t,r.f_present=!0,r.a_present&&o.send_(r.f(r.a))},!1)}),p=new i.Source(f.getVertex__(),function(){return f.listen_(o.getVertex__(),function(t){r.a=t,r.a_present=!0,r.f_present&&o.send_(r.f(r.a))},!1)});return o.setVertex__(new i.Vertex("apply",0,[h,p].concat(n?n:[]))),o.coalesce__(function(t,e){return e}).holdLazy(new s.Lazy(function(){return t.sampleNoTrans__()(e.sampleNoTrans__())}))})},t.switchC=function(t){return o.Transaction.transactionally(function(){var e=t.sampleLazy().map(function(t){return t.sample()}),n=new u.StreamWithSend,r=null,o=a.Operational.value(t),s=new i.Source(o.getVertex__(),function(){var t=null===r?null:a.Operational.value(r).listen_(n.getVertex__(),function(t){return n.send_(t)},!1),e=o.listen_(n.getVertex__(),function(e){r=e,null!==t&&t(),t=a.Operational.value(e).listen_(n.getVertex__(),function(t){return n.send_(t)},!1)},!1);return function(){e(),t()}});return n.setVertex__(new i.Vertex("switchC",0,[s])),n.coalesce__(function(t,e){return e}).holdLazy(e)})},t.switchS=function(t){return o.Transaction.transactionally(function(){var e=new u.StreamWithSend,n=function(t){e.send_(t)},r=new i.Source(t.getVertex__(),function(){var r=t.sampleNoTrans__().listen_(e.getVertex__(),n,!1),i=t.getStream__().listen_(e.getVertex__(),function(t){r(),r=t.listen_(e.getVertex__(),n,!0)},!1);return function(){i(),r()}});return e.setVertex__(new i.Vertex("switchS",0,[r])),e})},t.prototype.listen=function(t){var e=this;return o.Transaction.transactionally(function(){return a.Operational.value(e).listen(t)})},t}();e.Cell=f},function(t,e){"use strict";var n=function(){function t(t){this.f=t}return t.prototype.get=function(){return this.f()},t.prototype.map=function(e){var n=this;return new t(function(){return e(n.f())})},t.prototype.lift=function(e,n){var r=this;return new t(function(){return n(r.f(),e.f())})},t.prototype.lift3=function(e,n,r){var i=this;return new t(function(){return r(i.f(),e.f(),n.f())})},t.prototype.lift4=function(e,n,r,i){var o=this;return new t(function(){return i(o.f(),e.f(),n.f(),r.f())})},t}();e.Lazy=n},function(t,e,n){"use strict";var r=n(3),i=n(4),o=n(23),s=n(2),u=function(){function t(){}return t.updates=function(t){return t.getStream__()},t.value=function(e){return i.Transaction.transactionally(function(){var n=new r.StreamWithSend;i.Transaction.currentTransaction.prioritized(n.getVertex__(),function(){n.send_(o.Unit.UNIT)});var s=n.snapshot1(e);return t.updates(e).orElse(s)})},t.defer=function(e){return t.split(e.map(function(t){return[t]}))},t.split=function(t){var e=new r.StreamWithSend(null);return e.setVertex__(new s.Vertex("split",0,[new s.Source(t.getVertex__(),function(){return t.listen_(e.getVertex__(),function(t){for(var n=function(n){i.Transaction.currentTransaction.post(n,function(){i.Transaction.transactionally(function(){e.send_(t[n])})})},r=0;r<t.length;r++)n(r)},!1)})])),e},t}();e.Operational=u},function(t,e){"use strict";var n=function(){function t(){}return t.UNIT=new t,t}();e.Unit=n},function(t,e){"use strict";var n=function(){function t(t,e){this.h=t,this.target=e}return t}();e.Listener=n},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(20),o=n(4),s=function(t){function e(e,n){var r=this;t.call(this,null,null),o.Transaction.transactionally(function(){n&&r.setStream(n),r.lazyInitValue=e})}return r(e,t),e.prototype.sampleNoTrans__=function(){return null==this.value&&null!=this.lazyInitValue&&(this.value=this.lazyInitValue.get(),this.lazyInitValue=null),this.value},e}(i.Cell);e.LazyCell=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(3),o=n(19),s=n(4),u=function(t){function e(e){t.call(this),e||(e=function(t,e){throw new Error("send() called more than once per transaction, which isn't allowed. Did you want to combine the events? Then pass a combining function to your StreamSink constructor.")}),this.coalescer=new o.CoalesceHandler(e,this)}return r(e,t),e.prototype.send=function(t){var e=this;s.Transaction.transactionally(function(){if(s.Transaction.currentTransaction.inCallback>0)throw new Error("You are not allowed to use send() inside a Sodium callback");e.coalescer.send_(t)})},e}(i.StreamWithSend);e.StreamSink=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(25),o=n(4),s=n(3),u=function(t){function e(){t.call(this,null,new s.StreamLoop)}return r(e,t),e.prototype.loop=function(t){var e=this;o.Transaction.transactionally(function(){e.getStream__().loop(t.getStream__()),e.lazyInitValue=t.sampleLazy()})},e.prototype.sampleNoTrans__=function(){if(!this.getStream__().assigned__)throw new Error("CellLoop sampled before it was looped");return t.prototype.sampleNoTrans__.call(this)},e}(i.LazyCell);e.CellLoop=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(20),o=n(26),s=function(t){function e(e,n){t.call(this,e,new o.StreamSink(n))}return r(e,t),e.prototype.send=function(t){this.getStream__().send(t)},e}(i.Cell);e.CellSink=s},function(t,e){"use strict";var n=function(){function t(t,e){this.a=t,this.b=e}return t}();e.Tuple2=n},function(t,e,n){"use strict";var r=n(2),i=n(5),o=n(3),s=n(28),u=n(4),a=function(){function t(){}return t}();e.TimerSystemImpl=a;var c=0,l=function(){function t(t,e){this.t=t,this.sAlarm=e,this.seq=++c}return t}(),f=function(){function t(t){var e=this;this.eventQueue=new i.BSTree(function(t,e){return t.t<e.t?-1:t.t>e.t?1:t.seq<e.seq?-1:t.seq>e.seq?1:0}),u.Transaction.transactionally(function(){e.impl=t;var n=new s.CellSink(t.now());e.time=n,e.time.listen(function(t){}),u.Transaction.onStart(function(){for(var r=t.now(),i=function(){var t=null;if(!e.eventQueue.isEmpty()){var i=e.eventQueue.minimum();i.t<=r&&(t=i)}return null==t?"break":(n.send(t.t),void u.Transaction.transactionally(function(){return t.sAlarm.send_(t.t)}))};;){var o=i();if("break"===o)break}n.send(r)})})}return t.prototype.at=function(t){var e=this,n=null,i=null,s=!1,a=null,c=!1,f=new o.StreamWithSend(null),h=function(){null!==i&&(i(),e.eventQueue.remove(n)),i=null,n=null,s&&(c||(c=!0,a=t.sampleNoTrans__()),null!==a&&(n=new l(a,f),e.eventQueue.add(n),i=e.impl.setTimer(a,function(){u.Transaction.transactionally(function(){})})))};return f.setVertex__(new r.Vertex("at",0,[new r.Source(t.getVertex__(),function(){s=!0,c=!1,u.Transaction.currentTransaction.prioritized(f.getVertex__(),h);var e=t.getStream__().listen_(f.getVertex__(),function(t){a=t,c=!0,h()},!1);return function(){s=!1,h(),e()}})])),f},t}();e.TimerSystem=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(30),o=function(t){function e(){t.call(this,new s)}return r(e,t),e}(i.TimerSystem);e.SecondsTimerSystem=o;var s=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.setTimer=function(t,e){var n=setTimeout(e,1e3*(t-this.now()));return function(){clearTimeout(n)}},e.prototype.now=function(){return.001*Date.now()},e}(i.TimerSystemImpl)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(30),o=function(t){function e(){t.call(this,new s)}return r(e,t),e}(i.TimerSystem);e.MillisecondsTimerSystem=o;var s=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.setTimer=function(t,e){var n=setTimeout(e,t-this.now());return function(){clearTimeout(n)}},e.prototype.now=function(){return Date.now()},e}(i.TimerSystemImpl)},function(t,e,n){"use strict";var r=n(3),i=n(2),o=n(4),s=function(){function t(){}/*!
	     * Convert a function that performs asynchronous I/O taking input A
	     * and returning a value of type B into an I/O action of type
	     * (sa : Stream<A>) => Stream<B>
	     */
return t.fromAsync=function(t){return function(e){var n=new r.StreamWithSend(null);return n.setVertex__(new i.Vertex("map",0,[new i.Source(e.getVertex__(),function(){return e.listen_(n.getVertex__(),function(e){t(e,function(t){o.Transaction.transactionally(function(){n.send_(t)})})},!1)})])),n}},t}();e.IOAction=s}])});
//# sourceMappingURL=sodium.umd.min.js.map